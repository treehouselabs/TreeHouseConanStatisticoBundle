/**
 * TimePicker
 *
 * @param $timePicker
 * @constructor
 */
var StatisticoTimePickerUI = function($timePicker) {
  var currentValue;
  var self = this;
  var updateCallback;

  var onChange = function(e) {
    currentValue = $timePicker.val();

    if (updateCallback) {
      updateCallback(self.getValue(), self);
    }
  };

  this.setUpdateCallback = function(callback) {
    updateCallback = callback;
  };

  this.getValue = function() {
    return currentValue;
  };

  // init
  (function() {
    currentValue = $timePicker.val();

    // register listeners
    $timePicker.on('change', onChange)
  })();
};

/**
 * SearchInput
 *
 * @param $searchInput
 * @constructor
 */
var StatisticoSearchInputUI = function($searchInput) {
  var self = this;
  var updateCallback;
  var typingCallback;
  var currentValue;

  this.setUpdateCallback = function(callback) {
    updateCallback = callback;
  };

  this.setTypingCallback = function(callback) {
    typingCallback = callback;
  };

  this.getValue = function() {
    return currentValue;
  };

  this.focus = function() {
    $searchInput.focus();
    $searchInput.val($searchInput.val()); // moves cursor to end of input
  };

  var debounce = function(fn, delay) {
    var timer = null;

    return function (e) {
      var context = this, args = arguments;
      clearTimeout(timer);
      timer = setTimeout(function () {
        fn.apply(context, args);
      }, delay);
    };
  };

  var onKeyDownCancelReturn = function(e) {
    var keycode = e.keyCode || e.which;

    if (keycode == 13) {
      e.preventDefault();
    }
  };

  var onKeyDownForceChangeOnReturn = function(e) {
    var keycode = e.keyCode || e.which;

    if (keycode == 13) {
      onKeyUp(e);
    }
  };

  var onKeyUp = function(e) {
    if (e.currentTarget.value != currentValue) {
      currentValue = e.currentTarget.value;

      if (updateCallback) {
        updateCallback(self.getValue(), self);
      }
    }
  };

  var onKeyDownCallTypingCallback = function(e) {
    var keycode = e.keyCode || e.which;
    var valid =
        keycode == 8                     || // backspace
        (keycode > 47 && keycode < 58)   || // number keys
        keycode == 32                    || // spacebar
        (keycode > 64 && keycode < 91)   || // letter keys
        (keycode > 95 && keycode < 112)  || // numpad keys
        (keycode > 185 && keycode < 193) || // ;=,-./` (in order)
        (keycode > 218 && keycode < 223);   // [\]' (in order)

    if (typingCallback && valid) {
      typingCallback();
    }
  };

  // init
  (function() {
    currentValue = $searchInput.val();

    $searchInput.on('keyup', debounce(onKeyUp, 800));
    $searchInput.on('keydown', onKeyDownCancelReturn);
    $searchInput.on('keydown', onKeyDownForceChangeOnReturn);
    $searchInput.on('keydown', onKeyDownCallTypingCallback);
  })();
};

/**
 * Global Statistico UI
 *
 * @param {StatisticoSearchInputUI} $searchInput
 * @param {$} $bucketsContainer
 * @param {$} $loader
 * @param {StatisticoTimePickerUI} $timePicker
 * @param {string} baseUrl
 * @constructor
 */
var StatisticoUI = function($searchInput, $bucketsContainer, $loader, $timePicker, baseUrl) {
  var timePicker = new StatisticoTimePickerUI($timePicker);
  var searchInput = new StatisticoSearchInputUI($searchInput);
  var xhr;
  var self = this;
  var spinner_html = '<img class="spinner" width="20" height="20" src="data:image/gif;base64,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"/>';
  var currentQuery;

  var renderNotFound = function(query) {
    MG.data_graphic({
      chart_type: 'missing-data',
      missing_text: 'No buckets found for query "' + query + '"',
      target: $bucketsContainer.get(0),
      width: $bucketsContainer.width(),
      height: 200
    });
  };

  var renderBucket = function(bucket, onComplete) {
    var elementId = 'bucket-' + bucket.replace(/\./g, '_');

    $bucketsContainer.append('<div id="' + elementId + '" class="bucket"></div>');

    d3.json(baseUrl + '?action=data&bucket=' + bucket + '&from=' + timePicker.getValue(), function (data) {
      data.series = data.series.map(function (d) {
        d.date = new Date(d.date * 1000);
        return d;
      });

      MG.data_graphic({
        title: bucket,
        data: data.series,
        width: $bucketsContainer.width(),
        height: 150,
        target: '#' + elementId,
        x_accessor: 'date',
        y_accessor: 'count',
        interpolate: 'basic'
      });

      if (onComplete) {
        onComplete();
      }
    });
  };

  var showLoader = function() {
    $loader.html(spinner_html);
  };

  var hideLoader = function() {
    $loader.html('');
  };

  var updateUrl = function() {
    if (window.history && window.history.replaceState) {
      var state = history.state;
      var url = baseUrl;
      var nextSeparator = '?';

      if (currentQuery) {
        url = url + nextSeparator + 'q=' + encodeURI(currentQuery);
        nextSeparator = '&';
      }

      url = url + nextSeparator + 'from=' + encodeURI(timePicker.getValue());

      history.replaceState(state, document.title, url);
    }
  };

  this.search = function(query) {
    self.abort();

    if (!query) {
      return;
    }

    showLoader();

    xhr = $.ajax(baseUrl, {
      data: {
        action: "search",
        q: query
      },
      success: function(data) {
        currentQuery = query;
        $bucketsContainer.html('');

        if (0 == data.buckets.length) {
          renderNotFound(query);

          hideLoader();
          updateUrl();
        } else {
          // use a call stack to prevent overloading the backend.
          var callbackStack = [function() {
            hideLoader();
            updateUrl();
          }];

          $.each(data.buckets, function (i, bucket) {
            callbackStack[callbackStack.length] = function() {
              renderBucket(bucket, function() {
                if (callbackStack.length > 0) {
                  callbackStack.pop()();
                }
              });
            };
          });

          callbackStack[callbackStack.length - 1]();
        }
      },
      error: function() {
        hideLoader();
      }
    });
  };

  this.abort = function() {
    if (xhr) {
      xhr.abort();
    }

    hideLoader();

    $bucketsContainer.html('');
  };

  // init
  (function() {
    searchInput.setUpdateCallback(function(value) {
      self.search(value);
    });

    searchInput.setTypingCallback(function(value) {
      self.abort();
    });

    timePicker.setUpdateCallback(function() {
      self.search(currentQuery);
    });

    searchInput.focus();

    if (searchInput.getValue()) {
      self.search(searchInput.getValue());
    }
  })();
};
